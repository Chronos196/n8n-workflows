{"createdAt":"2024-08-30T12:53:15.952Z","updatedAt":"2024-08-30T12:53:15.952Z","id":"01SSIC4l6mPMBgOB","name":"logist","active":false,"nodes":[{"parameters":{"content":"## Блок сценария для логиста","height":862.4168334078684,"width":1267.9135979457083},"id":"667bd607-c9bc-4f95-9200-33b6f8d01ae3","name":"Sticky Note8","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1500,460]},{"parameters":{"chatId":"={{ $('Execute Workflow Trigger').item.json.message.chat.id }}","text":"Здравствуй, дорогой логист, приступим к работе?","replyMarkup":"replyKeyboard","replyKeyboard":{"rows":[{"row":{"buttons":[{"text":"Просмотреть свободные машины","additionalFields":{}}]}},{"row":{"buttons":[{"text":"Оповещение","additionalFields":{}}]}}]},"replyKeyboardOptions":{"resize_keyboard":true},"additionalFields":{"appendAttribution":false}},"id":"d6d2354a-3338-400e-b5c8-7d47cd353551","name":"Приветственное сообщений","type":"n8n-nodes-base.telegram","typeVersion":1.1,"position":[1640,580],"credentials":{"telegramApi":{"id":"rJQteGH5Ng1RKmF4","name":"tg dev aleksey"}}},{"parameters":{"chatId":"={{ $('Execute Workflow Trigger').item.json.message.chat.id }}","text":"Сейчас свободны следующие автомобили:","additionalFields":{"appendAttribution":false}},"id":"09cbef44-72d7-4fa3-8976-c0828681801f","name":"Проверка свободных машин","type":"n8n-nodes-base.telegram","typeVersion":1.1,"position":[2020,580],"credentials":{"telegramApi":{"id":"rJQteGH5Ng1RKmF4","name":"tg dev aleksey"}}},{"parameters":{"chatId":"={{ $('Execute Workflow Trigger').item.json.message.chat.id }}","text":"=<b>{{ $json.number_car }}, {{ $json.employee_id[1] }}</b>","additionalFields":{"appendAttribution":false,"parse_mode":"HTML"}},"id":"fd924886-3b21-4970-a7da-bdc037dd6d1d","name":"Вывод свободных машин","type":"n8n-nodes-base.telegram","typeVersion":1.1,"position":[2500,580],"credentials":{"telegramApi":{"id":"rJQteGH5Ng1RKmF4","name":"tg dev aleksey"}}},{"parameters":{"resource":"custom","customResource":"cars.cars","operation":"getAll","returnAll":true,"options":{"fieldsList":[]},"filterRequest":{"filter":[{"fieldName":"status","value":"Нет груза"}]}},"id":"411b7233-a306-44a2-b330-a9aaeda2987a","name":"Поиск машин со статусом Нет груза","type":"n8n-nodes-base.odoo","typeVersion":1,"position":[2260,580],"credentials":{"odooApi":{"id":"ITgOrhO4Hf2QcDtf","name":"odoo dev"}}},{"parameters":{"content":"## Вывод свободных машин","height":273.8075573041622,"width":779.3488585284206,"color":5},"id":"aa6513a2-8c6e-42cf-974c-57da23e735b1","name":"Sticky Note18","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1900,540]},{"parameters":{"chatId":"={{ $('Execute Workflow Trigger').item.json.message.chat.id }}","text":"Выберите вариант оповещения водителей:","replyMarkup":"inlineKeyboard","inlineKeyboard":{"rows":[{"row":{"buttons":[{"text":"Оповестить всех","additionalFields":{"callback_data":"logist_alert_all"}}]}},{"row":{"buttons":[{"text":"Оповестить по выбранному получателю","additionalFields":{"callback_data":"logist_alert_transportation"}}]}},{"row":{"buttons":[{"text":"Оповестить конкретный автомобиль","additionalFields":{"callback_data":"logist_alert_auto"}}]}}]},"additionalFields":{"appendAttribution":false}},"id":"eedaca9b-e5a4-4f03-86b9-c0fa69b3e778","name":"кнопка оповещения","type":"n8n-nodes-base.telegram","typeVersion":1.1,"position":[2040,1000],"credentials":{"telegramApi":{"id":"rJQteGH5Ng1RKmF4","name":"tg dev aleksey"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict"},"conditions":[{"id":"11c45e0d-196b-47f1-821e-bee57c9f070b","leftValue":"={{ $json.message.text }}","rightValue":"","operator":{"type":"string","operation":"exists","singleValue":true}}],"combinator":"and"},"options":{}},"id":"c8a36634-38f7-4100-a85c-214dde60a533","name":"проверка типа сообщения","type":"n8n-nodes-base.if","typeVersion":2,"position":[1140,1080]},{"parameters":{"errorMessage":"123"},"id":"0c457bd7-5cd8-4984-9dba-d5b903c070ee","name":"Stop and Error","type":"n8n-nodes-base.stopAndError","typeVersion":1,"position":[960,1280],"disabled":true},{"parameters":{"operation":"editMessageText","chatId":"={{ $('Execute Workflow Trigger').item.json.callback_query.message.chat.id }}","messageId":"={{ $('Execute Workflow Trigger').item.json.callback_query.message.message_id }}","replyMarkup":"inlineKeyboard","text":"Введите текст сообщения для всех водителей:","inlineKeyboard":{"rows":[{"row":{"buttons":[{"text":"Назад","additionalFields":{"callback_data":"back_to_alert_menu"}}]}}]},"additionalFields":{}},"id":"067896ae-27a2-4c41-8f81-2fa4c85e3022","name":"введите текст для всех","type":"n8n-nodes-base.telegram","typeVersion":1.1,"position":[1600,1480],"credentials":{"telegramApi":{"id":"rJQteGH5Ng1RKmF4","name":"tg dev aleksey"}}},{"parameters":{"operation":"update","schema":{"__rl":true,"mode":"list","value":"public"},"table":{"__rl":true,"value":"tg_users","mode":"list","cachedResultName":"tg_users"},"columns":{"mappingMode":"defineBelow","value":{"tg_id":"={{ $('Execute Workflow Trigger').item.json.callback_query.message.chat.id }}","status":"inputing_alert_for_all"},"matchingColumns":["tg_id"],"schema":[{"id":"tg_id","displayName":"tg_id","required":true,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":false},{"id":"odoo_id","displayName":"odoo_id","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"status","displayName":"status","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"only_mech","displayName":"only_mech","required":false,"defaultMatch":false,"display":true,"type":"boolean","canBeUsedToMatch":true,"removed":true},{"id":"mech_photo","displayName":"mech_photo","required":false,"defaultMatch":false,"display":true,"type":"boolean","canBeUsedToMatch":true,"removed":true},{"id":"end_request_id","displayName":"end_request_id","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"materials_photo","displayName":"materials_photo","required":false,"defaultMatch":false,"display":true,"type":"boolean","canBeUsedToMatch":true,"removed":true},{"id":"end_request_hours","displayName":"end_request_hours","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"car_id_while_inputing","displayName":"car_id_while_inputing","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"fuel_liters","displayName":"fuel_liters","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"weight_measure","displayName":"weight_measure","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true}]},"options":{}},"id":"dd90ca57-51bf-49ca-bc4b-b2ad6fb929a7","name":"статус=ввод оповещения для всех","type":"n8n-nodes-base.postgres","typeVersion":2.3,"position":[1800,1480],"credentials":{"postgres":{"id":"xrihBpyZE5y4OBiy","name":"pg dev"}}},{"parameters":{"operation":"editMessageText","chatId":"={{ $('Execute Workflow Trigger').item.json.callback_query.message.chat.id }}","messageId":"={{ $('Execute Workflow Trigger').item.json.callback_query.message.message_id }}","replyMarkup":"inlineKeyboard","text":"Выберите вариант оповещения водителей:","inlineKeyboard":{"rows":[{"row":{"buttons":[{"text":"Оповестить всех","additionalFields":{"callback_data":"logist_alert_all"}}]}},{"row":{"buttons":[{"text":"Оповестить по выбранной перевозке","additionalFields":{"callback_data":"logist_alert_transportation"}}]}},{"row":{"buttons":[{"text":"Оповестить конкретный автомобиль","additionalFields":{"callback_data":"logist_alert_auto"}}]}}]},"additionalFields":{}},"id":"f0ddf851-3eeb-4f96-8378-7555cfa57919","name":"кнопка оповещения1","type":"n8n-nodes-base.telegram","typeVersion":1.1,"position":[1600,1860],"credentials":{"telegramApi":{"id":"rJQteGH5Ng1RKmF4","name":"tg dev aleksey"}}},{"parameters":{"operation":"select","schema":{"__rl":true,"mode":"list","value":"public"},"table":{"__rl":true,"value":"tg_users","mode":"list","cachedResultName":"tg_users"},"returnAll":true,"where":{"values":[{"column":"odoo_id","value":"={{ $json.driver_id[0] }}"}]},"options":{}},"id":"33288ac5-6033-4827-a634-2221616b5712","name":"айди водителей","type":"n8n-nodes-base.postgres","typeVersion":2.3,"position":[1800,2040],"credentials":{"postgres":{"id":"xrihBpyZE5y4OBiy","name":"pg dev"}}},{"parameters":{"chatId":"={{ $('айди водителей').item.json.tg_id }}","text":"=Оповещение от логиста:\n<i>{{ $('Execute Workflow Trigger').item.json.logist_alert_text }}</i>","additionalFields":{"appendAttribution":false,"parse_mode":"HTML"}},"id":"f86143c1-77c5-407d-9b60-4e2bfab05979","name":"рассылка","type":"n8n-nodes-base.telegram","typeVersion":1.1,"position":[2040,2040],"credentials":{"telegramApi":{"id":"rJQteGH5Ng1RKmF4","name":"tg dev aleksey"}}},{"parameters":{"operation":"update","schema":{"__rl":true,"mode":"list","value":"public"},"table":{"__rl":true,"value":"tg_users","mode":"list","cachedResultName":"tg_users"},"columns":{"mappingMode":"defineBelow","value":{"tg_id":"={{ $('Execute Workflow Trigger').item.json.message.chat.id }}","status":"authorized","logist_alert_text":"={{ $('Execute Workflow Trigger').item.json.message.text }}"},"matchingColumns":["tg_id"],"schema":[{"id":"tg_id","displayName":"tg_id","required":true,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":false},{"id":"odoo_id","displayName":"odoo_id","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"status","displayName":"status","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"only_mech","displayName":"only_mech","required":false,"defaultMatch":false,"display":true,"type":"boolean","canBeUsedToMatch":true,"removed":true},{"id":"mech_photo","displayName":"mech_photo","required":false,"defaultMatch":false,"display":true,"type":"boolean","canBeUsedToMatch":true,"removed":true},{"id":"end_request_id","displayName":"end_request_id","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"materials_photo","displayName":"materials_photo","required":false,"defaultMatch":false,"display":true,"type":"boolean","canBeUsedToMatch":true,"removed":true},{"id":"end_request_hours","displayName":"end_request_hours","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"car_id_while_inputing","displayName":"car_id_while_inputing","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"fuel_liters","displayName":"fuel_liters","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"weight_measure","displayName":"weight_measure","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"logist_alert_text","displayName":"logist_alert_text","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true}]},"options":{}},"id":"fabae3c7-9122-4f35-be7f-56c68ceb6962","name":"сохраним текст логиста","type":"n8n-nodes-base.postgres","typeVersion":2.3,"position":[3720,1440],"credentials":{"postgres":{"id":"xrihBpyZE5y4OBiy","name":"pg dev"}}},{"parameters":{"content":"## Оповещения для всех водителей на смене","height":799.4991199079257,"width":1321.0782113186833,"color":6},"id":"97829273-4ced-4c97-83db-6e391617a84c","name":"Sticky Note","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1520,1420]},{"parameters":{"aggregate":"aggregateAllItemData","options":{}},"id":"ed4eff8a-8e75-45b1-ad20-fa3e2ccf21f8","name":"преобразуем в 1 переменную","type":"n8n-nodes-base.aggregate","typeVersion":1,"position":[2280,2040]},{"parameters":{"resource":"custom","customResource":"transportation.transportation","operation":"getAll","returnAll":true,"options":{},"filterRequest":{"filter":[{"fieldName":"date","value":"={{ $today }}"}]}},"id":"551285dc-1ef5-4e62-ba3d-289404d477ff","name":"все сегодняшние перевозки","type":"n8n-nodes-base.odoo","typeVersion":1,"position":[1600,1680],"alwaysOutputData":true,"credentials":{"odooApi":{"id":"ITgOrhO4Hf2QcDtf","name":"odoo dev"}}},{"parameters":{"compare":"selectedFields","fieldsToCompare":"partner[1]","options":{}},"id":"268840e3-b843-4d09-9ce1-2029572c137e","name":"получим получателей без дубликатов","type":"n8n-nodes-base.removeDuplicates","typeVersion":1,"position":[2040,1620]},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict"},"conditions":[{"id":"6d3ef479-f9d1-4c48-9141-f8120a69fece","leftValue":"={{ $json }}","rightValue":"","operator":{"type":"object","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"options":{}},"id":"75368294-e9d3-41f0-a8b1-e52d90ff716e","name":"проверка наличия перевозок","type":"n8n-nodes-base.if","typeVersion":2,"position":[1800,1680]},{"parameters":{"resource":"callback","queryId":"={{ $('Execute Workflow Trigger').item.json.callback_query.id }}","additionalFields":{"show_alert":true,"text":"Перевозки на сегодня не найдены"}},"id":"d4f394e4-1dd1-42f2-b027-8dd2c2346ccb","name":"заявки не найдены","type":"n8n-nodes-base.telegram","typeVersion":1.1,"position":[2040,1800],"credentials":{"telegramApi":{"id":"rJQteGH5Ng1RKmF4","name":"tg dev aleksey"}}},{"parameters":{"jsCode":"const items = $input.all();\n\nconst buttons = items.map((item, index) => ({\n    text: `${item.json.partner[1]}`,\n    callback_data: `AT_${item.json.partner[1]}` // AT - alert transportation\n}));\n\nconst inlineKeyboard = {\n    inline_keyboard: buttons.map(button => [button])\n};\nconst chatId = $('Execute Workflow Trigger').all()[0].json.callback_query.message.chat.id \nconst token = '7063451965:AAGARL6Eluwh3zgS84WnaZozqdz6-m0RLzg';\nconst url = `https://api.telegram.org/bot${token}/sendMessage`;\n\nconst message = {\n    chat_id: chatId,\n    text: \"Нажмите на получателя\",\n    reply_markup: inlineKeyboard\n};\n\n// Возвращаем данные для запроса\nreturn [\n    {\n        json: {\n            url,\n            message\n        }\n    }\n];\n"},"id":"781e48e2-e8dc-47e4-a3ac-b8d4c39913d4","name":"создаём динамически инлайн кнопки","type":"n8n-nodes-base.code","typeVersion":2,"position":[2260,1620]},{"parameters":{"method":"POST","url":"={{ $json.url }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ $json.message }}","options":{}},"id":"f492b361-5053-40f1-b63c-0d3ae648a86c","name":"отправляем сообщение","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[2480,1620]},{"parameters":{"operation":"deleteMessage","chatId":"={{ $('Execute Workflow Trigger').all()[0].json.callback_query.message.chat.id }}","messageId":"={{ $('Execute Workflow Trigger').all()[0].json.callback_query.message.message_id }}"},"id":"d790a0f3-0f3d-4df6-a63b-d19255a7cbf7","name":"удаляем прошлое сообщение с заявками","type":"n8n-nodes-base.telegram","typeVersion":1.1,"position":[2700,1620],"credentials":{"telegramApi":{"id":"rJQteGH5Ng1RKmF4","name":"tg dev aleksey"}}},{"parameters":{"operation":"editMessageText","chatId":"={{ $('Execute Workflow Trigger').item.json.callback_query.message.chat.id }}","messageId":"={{ $('Execute Workflow Trigger').item.json.callback_query.message.message_id }}","replyMarkup":"inlineKeyboard","text":"=Вы выбрали получателя <b>{{ $json[\"AT_name\"] }}</b>. Введите текст сообщения для водителей:","inlineKeyboard":{"rows":[{"row":{"buttons":[{"text":"Назад","additionalFields":{"callback_data":"logist_alert_transportation"}}]}}]},"additionalFields":{"parse_mode":"HTML"}},"id":"7e3fc808-0142-4f8c-9a78-f0c38dc08652","name":"введите текст для получателя","type":"n8n-nodes-base.telegram","typeVersion":1.1,"position":[1880,2980],"credentials":{"telegramApi":{"id":"rJQteGH5Ng1RKmF4","name":"tg dev aleksey"}}},{"parameters":{"assignments":{"assignments":[{"id":"92ad7c1c-cd84-4fc3-bf35-ca59aedad2a0","name":"AT_name","value":"={{ $json.callback_query.data.substring(3) }}","type":"string"}]},"options":{}},"id":"8d198590-2f62-4588-8a19-147bc424ba20","name":"название получателя","type":"n8n-nodes-base.set","typeVersion":3.3,"position":[1640,2980]},{"parameters":{"operation":"update","schema":{"__rl":true,"mode":"list","value":"public"},"table":{"__rl":true,"value":"tg_users","mode":"list","cachedResultName":"tg_users"},"columns":{"mappingMode":"defineBelow","value":{"status":"inputing_alert_for_transportation","tg_id":"={{ $('Execute Workflow Trigger').item.json.callback_query.message.chat.id }}","logist_recipient_name":"={{ $('название получателя').item.json.AT_name }}"},"matchingColumns":["tg_id"],"schema":[{"id":"tg_id","displayName":"tg_id","required":true,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":false},{"id":"odoo_id","displayName":"odoo_id","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"status","displayName":"status","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"only_mech","displayName":"only_mech","required":false,"defaultMatch":false,"display":true,"type":"boolean","canBeUsedToMatch":true,"removed":true},{"id":"mech_photo","displayName":"mech_photo","required":false,"defaultMatch":false,"display":true,"type":"boolean","canBeUsedToMatch":true,"removed":true},{"id":"end_request_id","displayName":"end_request_id","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"materials_photo","displayName":"materials_photo","required":false,"defaultMatch":false,"display":true,"type":"boolean","canBeUsedToMatch":true,"removed":true},{"id":"end_request_hours","displayName":"end_request_hours","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"car_id_while_inputing","displayName":"car_id_while_inputing","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"fuel_liters","displayName":"fuel_liters","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"weight_measure","displayName":"weight_measure","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"logist_alert_text","displayName":"logist_alert_text","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"logist_recipient_name","displayName":"logist_recipient_name","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false}]},"options":{}},"id":"d113ce7e-d0be-448b-b729-a0392c6145d6","name":"статус=ввод сообщения для получателя","type":"n8n-nodes-base.postgres","typeVersion":2.3,"position":[2100,2980],"credentials":{"postgres":{"id":"xrihBpyZE5y4OBiy","name":"pg dev"}}},{"parameters":{"chatId":"={{ $('Execute Workflow Trigger').item.json.message.chat.id }}","text":"=<b>Действительно хотите оповестить всех водителей по выбранному получателю?</b>\n\nВаше сообщение:\n<i>{{ $('Execute Workflow Trigger').item.json.message.text }}</i>","replyMarkup":"inlineKeyboard","inlineKeyboard":{"rows":[{"row":{"buttons":[{"text":"Оповестить","additionalFields":{"callback_data":"alert_transportation"}}]}},{"row":{"buttons":[{"text":"Вернуться к выбору","additionalFields":{"callback_data":"back_to_alert_menu"}}]}}]},"additionalFields":{"appendAttribution":false,"parse_mode":"HTML"}},"id":"be36d16e-6ad9-45a4-a8c4-2a04957a45c5","name":"оповестить по перевозке?","type":"n8n-nodes-base.telegram","typeVersion":1.1,"position":[3240,1440],"credentials":{"telegramApi":{"id":"rJQteGH5Ng1RKmF4","name":"tg dev aleksey"}}},{"parameters":{"operation":"update","schema":{"__rl":true,"mode":"list","value":"public"},"table":{"__rl":true,"value":"tg_users","mode":"list","cachedResultName":"tg_users"},"columns":{"mappingMode":"defineBelow","value":{"tg_id":"={{ $('Execute Workflow Trigger').item.json.inline_chat_id }}","status":"authorized"},"matchingColumns":["tg_id"],"schema":[{"id":"tg_id","displayName":"tg_id","required":true,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":false},{"id":"odoo_id","displayName":"odoo_id","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"status","displayName":"status","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"only_mech","displayName":"only_mech","required":false,"defaultMatch":false,"display":true,"type":"boolean","canBeUsedToMatch":true,"removed":true},{"id":"mech_photo","displayName":"mech_photo","required":false,"defaultMatch":false,"display":true,"type":"boolean","canBeUsedToMatch":true,"removed":true},{"id":"end_request_id","displayName":"end_request_id","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"materials_photo","displayName":"materials_photo","required":false,"defaultMatch":false,"display":true,"type":"boolean","canBeUsedToMatch":true,"removed":true},{"id":"end_request_hours","displayName":"end_request_hours","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"car_id_while_inputing","displayName":"car_id_while_inputing","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"fuel_liters","displayName":"fuel_liters","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"weight_measure","displayName":"weight_measure","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true}]},"options":{}},"id":"9bcbdd78-63a8-44a0-ad75-5ed1a25d56c7","name":"дефолтный статус","type":"n8n-nodes-base.postgres","typeVersion":2.3,"position":[1800,1860],"credentials":{"postgres":{"id":"xrihBpyZE5y4OBiy","name":"pg dev"}},"disabled":true},{"parameters":{"resource":"custom","customResource":"transportation.transportation","operation":"getAll","returnAll":true,"options":{},"filterRequest":{"filter":[{"fieldName":"partner","value":"={{ $('Execute Workflow Trigger').item.json.logist_recipient_name }}"},{"fieldName":"date","value":"={{ $today }}"}]}},"id":"201afb4c-3d47-43c3-80cc-1570c2bb20da","name":"перевозки по получателю","type":"n8n-nodes-base.odoo","typeVersion":1,"position":[1640,3220],"credentials":{"odooApi":{"id":"ITgOrhO4Hf2QcDtf","name":"odoo dev"}}},{"parameters":{"jsCode":"// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nvar rounds = [];\nfor (const item of $input.all()) {\n  for(const round of item.json.rounds) {\n    rounds.push(round);\n  }\n}\n\nreturn {\"rounds\": rounds};"},"id":"0ffc3855-8ab1-465d-856d-1777b503f5af","name":"все рейсы","type":"n8n-nodes-base.code","typeVersion":2,"position":[1880,3220]},{"parameters":{"resource":"custom","customResource":"cars.cars","operation":"getAll","returnAll":true,"options":{},"filterRequest":{"filter":[{"fieldName":"driver_id","operator":"notEqual","value":"={{ false }}"}]}},"id":"5222c671-4467-4b92-9ff9-edf507962aff","name":"поиск машин на смене","type":"n8n-nodes-base.odoo","typeVersion":1,"position":[1600,2040],"alwaysOutputData":true,"credentials":{"odooApi":{"id":"ITgOrhO4Hf2QcDtf","name":"odoo dev"}}},{"parameters":{"resource":"custom","customResource":"cars.cars","operation":"getAll","returnAll":true,"options":{},"filterRequest":{"filter":[{"fieldName":"rounds","value":"={{ $json.rounds }}"},{"fieldName":"driver_id","operator":"notEqual","value":"={{ false }}"}]}},"id":"d4acafcc-0ec3-413d-bda4-42032f9d529b","name":"автомобили по рейсу на смене","type":"n8n-nodes-base.odoo","typeVersion":1,"position":[2100,3220],"credentials":{"odooApi":{"id":"ITgOrhO4Hf2QcDtf","name":"odoo dev"}}},{"parameters":{"operation":"select","schema":{"__rl":true,"mode":"list","value":"public"},"table":{"__rl":true,"value":"tg_users","mode":"list","cachedResultName":"tg_users"},"returnAll":true,"where":{"values":[{"column":"odoo_id","value":"={{ $json.driver_id[0] }}"}]},"options":{}},"id":"05dc6b47-bc01-427f-8f01-5b03729244de","name":"айди водителей1","type":"n8n-nodes-base.postgres","typeVersion":2.3,"position":[2340,3220],"credentials":{"postgres":{"id":"xrihBpyZE5y4OBiy","name":"pg dev"}}},{"parameters":{"chatId":"={{ $('айди водителей1').item.json.tg_id }}","text":"=Оповещение от логиста:\n<i>{{ $('Execute Workflow Trigger').all()[0].json.logist_alert_text }}</i>","additionalFields":{"appendAttribution":false,"parse_mode":"HTML"}},"id":"b62fddf5-dce5-4de8-abee-e3a5d1cf51ff","name":"рассылка1","type":"n8n-nodes-base.telegram","typeVersion":1.1,"position":[2560,3220],"credentials":{"telegramApi":{"id":"rJQteGH5Ng1RKmF4","name":"tg dev aleksey"}}},{"parameters":{"aggregate":"aggregateAllItemData","options":{}},"id":"b59429ce-956c-4aa9-bc96-a86d3f6a63c1","name":"преобразуем в 1 переменную1","type":"n8n-nodes-base.aggregate","typeVersion":1,"position":[2800,3220]},{"parameters":{"operation":"editMessageText","chatId":"={{ $('Execute Workflow Trigger').all()[0].json.callback_query.message.chat.id }}","messageId":"={{ $('Execute Workflow Trigger').all()[0].json.callback_query.message.message_id }}","text":"Сообщение будет доставлено всем водителям с выбранным получателем","additionalFields":{}},"id":"a2608254-77c2-4638-a782-76db23a66b4d","name":"изменяем сообщение1","type":"n8n-nodes-base.telegram","typeVersion":1.1,"position":[3020,3220],"credentials":{"telegramApi":{"id":"rJQteGH5Ng1RKmF4","name":"tg dev aleksey"}}},{"parameters":{"content":"## Оповещения по получателю","height":496.20554104438617,"width":1722.0426037145492,"color":6},"id":"c0fefdea-6a47-4b9a-8792-ace666330f5f","name":"Sticky Note1","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1580,2920]},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict"},"conditions":[{"leftValue":"={{ $json.message.text }}","rightValue":"={{ \"/start\" }}","operator":{"type":"string","operation":"equals"}}],"combinator":"and"}}]},"options":{"fallbackOutput":"extra"}},"id":"95dbc50e-19ca-4017-ac04-9a5ed613dac4","name":"Проверка старта1","type":"n8n-nodes-base.switch","typeVersion":3,"position":[1520,980]},{"parameters":{"resource":"custom","customResource":"transportation.transportation","operation":"getAll","returnAll":true,"options":{},"filterRequest":{"filter":[{"fieldName":"date","value":"={{ $today }}"}]}},"id":"468af567-e556-4c15-a1d4-3b325a5e2023","name":"все сегодняшние перевозки1","type":"n8n-nodes-base.odoo","typeVersion":1,"position":[1620,2420],"alwaysOutputData":true,"credentials":{"odooApi":{"id":"ITgOrhO4Hf2QcDtf","name":"odoo dev"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict"},"conditions":[{"id":"6d3ef479-f9d1-4c48-9141-f8120a69fece","leftValue":"={{ $json }}","rightValue":"","operator":{"type":"object","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"options":{}},"id":"cd5751cf-4bcf-4e93-8392-4e00af844464","name":"проверка наличия перевозок1","type":"n8n-nodes-base.if","typeVersion":2,"position":[1820,2420]},{"parameters":{"resource":"callback","queryId":"={{ $('Execute Workflow Trigger').item.json.callback_query.id }}","additionalFields":{"show_alert":true,"text":"Перевозки на сегодня не найдены"}},"id":"263f4902-fcb3-4dfa-aa6c-e5af03c1b72b","name":"заявки не найдены1","type":"n8n-nodes-base.telegram","typeVersion":1.1,"position":[2060,2540],"credentials":{"telegramApi":{"id":"rJQteGH5Ng1RKmF4","name":"tg dev aleksey"}}},{"parameters":{"compare":"selectedFields","fieldsToCompare":"partner[1]","options":{}},"id":"4b08a1a7-6877-4967-832f-b89a203c8570","name":"получим получателей без дубликатов1","type":"n8n-nodes-base.removeDuplicates","typeVersion":1,"position":[2060,2360]},{"parameters":{"jsCode":"const items = $input.all();\n\nconst buttons = items.map((item, index) => ({\n    text: `${item.json.partner[1]}`,\n    callback_data: `CT_${item.json.partner[1]}` // CT - Choise Transportation for auto alert\n}));\n\nconst inlineKeyboard = {\n    inline_keyboard: buttons.map(button => [button])\n};\nconst chatId = $('Execute Workflow Trigger').all()[0].json.callback_query.message.chat.id \nconst token = '7063451965:AAGARL6Eluwh3zgS84WnaZozqdz6-m0RLzg';\nconst url = `https://api.telegram.org/bot${token}/sendMessage`;\n\nconst message = {\n    chat_id: chatId,\n    text: \"Чтобы найти автомобиль, выберите получателя:\",\n    reply_markup: inlineKeyboard\n};\n\n// Возвращаем данные для запроса\nreturn [\n    {\n        json: {\n            url,\n            message\n        }\n    }\n];\n"},"id":"3091fe11-7ce3-4966-b4d8-64d55af18279","name":"создаём динамически инлайн кнопки1","type":"n8n-nodes-base.code","typeVersion":2,"position":[2280,2360]},{"parameters":{"method":"POST","url":"={{ $json.url }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ $json.message }}","options":{}},"id":"5be9c34f-7d8f-4cfb-8b1f-cfb451d65808","name":"отправляем сообщение1","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[2500,2360]},{"parameters":{"operation":"deleteMessage","chatId":"={{ $('Execute Workflow Trigger').all()[0].json.callback_query.message.chat.id }}","messageId":"={{ $('Execute Workflow Trigger').all()[0].json.callback_query.message.message_id }}"},"id":"d3da7a85-d1dd-4ac8-905f-6f8092f61735","name":"удаляем прошлое сообщение с заявками1","type":"n8n-nodes-base.telegram","typeVersion":1.1,"position":[2720,2360],"credentials":{"telegramApi":{"id":"rJQteGH5Ng1RKmF4","name":"tg dev aleksey"}}},{"parameters":{"resource":"custom","customResource":"transportation.transportation","operation":"getAll","returnAll":true,"options":{},"filterRequest":{"filter":[{"fieldName":"partner","value":"={{ $json.callback_query.data.substring(3) }}"},{"fieldName":"date","value":"={{ $today }}"}]}},"id":"7f87cd62-10a8-4fb6-9a10-da77c22a6c99","name":"перевозки по получателю1","type":"n8n-nodes-base.odoo","typeVersion":1,"position":[1620,3589],"credentials":{"odooApi":{"id":"ITgOrhO4Hf2QcDtf","name":"odoo dev"}}},{"parameters":{"jsCode":"// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nvar rounds = [];\nfor (const item of $input.all()) {\n  for(const round of item.json.rounds) {\n    rounds.push(round);\n  }\n}\n\nreturn {\"rounds\": rounds};"},"id":"ab65d3b0-1aae-4a19-aee0-fe655bb86a2d","name":"все рейсы1","type":"n8n-nodes-base.code","typeVersion":2,"position":[1860,3589]},{"parameters":{"resource":"custom","customResource":"cars.cars","operation":"getAll","returnAll":true,"options":{},"filterRequest":{"filter":[{"fieldName":"rounds","value":"={{ $json.rounds }}"},{"fieldName":"driver_id","operator":"notEqual","value":"={{ false }}"}]}},"id":"7f9292d5-38f2-4cde-ba87-f12c837c3011","name":"автомобили по рейсу на смене1","type":"n8n-nodes-base.odoo","typeVersion":1,"position":[2100,3589],"credentials":{"odooApi":{"id":"ITgOrhO4Hf2QcDtf","name":"odoo dev"}}},{"parameters":{"jsCode":"const items = $input.all();\n\nconst buttons = items.map((item, index) => ({\n    text: `${item.json.number_car}`,\n    callback_data: `AA_${item.json.number_car}` // AA - Alert Auto\n}));\n\nconst inlineKeyboard = {\n    inline_keyboard: buttons.map(button => [button])\n};\nconst chatId = $('Execute Workflow Trigger').all()[0].json.callback_query.message.chat.id \nconst token = '7063451965:AAGARL6Eluwh3zgS84WnaZozqdz6-m0RLzg';\nconst url = `https://api.telegram.org/bot${token}/sendMessage`;\n\nvar partner = $('Execute Workflow Trigger').all()[0].json.callback_query.data.substring(3);\n\nconst message = {\n    chat_id: chatId,\n    text: \"Текущие автомобили на смене с получателем <b>\" + partner + \"</b>:\",\n    reply_markup: inlineKeyboard,\n    parse_mode: \"html\",\n};\n\n// Возвращаем данные для запроса\nreturn [\n    {\n        json: {\n            url,\n            message,\n        }\n    }\n];\n"},"id":"e43d24e6-245c-477b-b339-deb15af9f764","name":"создаём динамически инлайн кнопки2","type":"n8n-nodes-base.code","typeVersion":2,"position":[2360,3589]},{"parameters":{"method":"POST","url":"={{ $json.url }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ $json.message }}","options":{}},"id":"a542d81a-f040-4d38-b1a4-2d7786015b5c","name":"отправляем сообщение2","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[2580,3589]},{"parameters":{"operation":"deleteMessage","chatId":"={{ $('Execute Workflow Trigger').all()[0].json.callback_query.message.chat.id }}","messageId":"={{ $('Execute Workflow Trigger').all()[0].json.callback_query.message.message_id }}"},"id":"27a44cab-d860-4e10-8485-ad71db57ba90","name":"удаляем прошлое сообщение с заявками2","type":"n8n-nodes-base.telegram","typeVersion":1.1,"position":[2980,3600],"credentials":{"telegramApi":{"id":"rJQteGH5Ng1RKmF4","name":"tg dev aleksey"}}},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict"},"conditions":[{"leftValue":"={{ $json.message.text }}","rightValue":"Просмотреть свободные машины","operator":{"type":"string","operation":"equals"}}],"combinator":"and"}},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict"},"conditions":[{"id":"34002e05-61b0-40d3-884d-45ed94368732","leftValue":"={{ $json.message.text }}","rightValue":"Оповещение","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"}}]},"options":{"fallbackOutput":"extra"}},"id":"f6590b2b-8a6a-4fbe-abd2-a281fc1dd2d8","name":"Проверка кнопок","type":"n8n-nodes-base.switch","typeVersion":3,"position":[1760,1000]},{"parameters":{"content":"## Выбор получателя при оповещении конкретного авто","height":458.39652118337546,"width":1328.4103837921157,"color":6},"id":"c4edfa8d-28d0-4898-a567-7636b9cb256d","name":"Sticky Note2","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1540,2280]},{"parameters":{"content":"## Выбор авто при оповещении конкретного авто","height":291.3280243517646,"width":1517.8363177636575,"color":6},"id":"0d4d2dfe-c0aa-477e-8cce-7563e609776c","name":"Sticky Note3","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1600,3500]},{"parameters":{"content":"## Сокращения\nAT - alert transportation - оповещение по получателю\nCT - Choise Transportation - оповещение по конкретному авто\nAA - Alert Auto - оповещение по конкретному авто","width":385.0592683521705,"color":4},"id":"9c3dbc29-309c-448b-abc9-12f0d649696d","name":"Sticky Note4","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[460,460]},{"parameters":{"resource":"custom","customResource":"cars.cars","operation":"getAll","returnAll":true,"options":{},"filterRequest":{"filter":[{"fieldName":"number_car","value":"={{ $json.callback_query.data.substring(3) }}"}]}},"id":"dc22212f-4b09-44fe-81da-10995cf6fc8a","name":"данные авто","type":"n8n-nodes-base.odoo","typeVersion":1,"position":[1620,3880],"alwaysOutputData":true,"credentials":{"odooApi":{"id":"ITgOrhO4Hf2QcDtf","name":"odoo dev"}}},{"parameters":{"resource":"custom","customResource":"hr.employee","operation":"get","customResourceId":"={{ $json.driver_id[0] }}","options":{"fieldsList":["mobile_phone"]}},"id":"0ad76ed2-0620-4fae-a608-84cddfba4cae","name":"номер телефона","type":"n8n-nodes-base.odoo","typeVersion":1,"position":[1840,3880],"credentials":{"odooApi":{"id":"ITgOrhO4Hf2QcDtf","name":"odoo dev"}}},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict"},"conditions":[{"leftValue":"={{ $json.callback_query.data }}","rightValue":"logist_alert_all","operator":{"type":"string","operation":"equals"}}],"combinator":"and"}},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict"},"conditions":[{"id":"424c6e2a-a988-406f-9a0a-13a079991adb","leftValue":"={{ $json.callback_query.data }}","rightValue":"logist_alert_transportation","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"}},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict"},"conditions":[{"id":"89372a57-be12-40be-9a51-4fa9938c8205","leftValue":"={{ $json.callback_query.data }}","rightValue":"back_to_alert_menu","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"}},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict"},"conditions":[{"id":"16d7aef0-6c20-4f44-a9ee-46c21e2a786f","leftValue":"={{ $json.callback_query.data }}","rightValue":"alert_all","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"}},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict"},"conditions":[{"id":"5b842fea-b857-45e2-95ad-6e5dc9d17200","leftValue":"={{ $json.callback_query.data }}","rightValue":"logist_alert_auto","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"}}]},"options":{"fallbackOutput":"extra"}},"id":"ed064e22-b920-4b3c-9415-d836dad8b866","name":"инлайн кнопки для логиста","type":"n8n-nodes-base.switch","typeVersion":3,"position":[1340,1760]},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict"},"conditions":[{"leftValue":"={{ $json.status }}","rightValue":"inputing_alert_for_all","operator":{"type":"string","operation":"equals"}}],"combinator":"and"}},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict"},"conditions":[{"id":"14da08f2-eaa2-4a05-a2ec-e02fa0ec245d","leftValue":"={{ $json.status }}","rightValue":"inputing_alert_for_transportation","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"}},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict"},"conditions":[{"id":"63789235-8337-4a36-b64f-d3c931980c3d","leftValue":"={{ $json.status }}","rightValue":"inputing_alert_for_auto","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"}}]},"options":{}},"id":"a2638fc8-5adf-4655-8a4c-ec001db86c07","name":"проверка статуса","type":"n8n-nodes-base.switch","typeVersion":3,"position":[3000,1440]},{"parameters":{"operation":"editMessageText","chatId":"={{ $('Execute Workflow Trigger').item.json.message.chat.id }}","messageId":"={{ $('Execute Workflow Trigger').item.json.message.message_id -1 }}","text":"Введите текст сообщения для всех водителей:","additionalFields":{}},"id":"57cd4b1d-31a3-46c0-9ad0-b0258c36fdd9","name":"убираем кнопку назад","type":"n8n-nodes-base.telegram","typeVersion":1.1,"position":[3460,1240],"credentials":{"telegramApi":{"id":"rJQteGH5Ng1RKmF4","name":"tg dev aleksey"}},"onError":"continueRegularOutput"},{"parameters":{},"id":"450d80bf-9830-479f-b216-0f523c1b39a6","name":"Execute Workflow Trigger","type":"n8n-nodes-base.executeWorkflowTrigger","typeVersion":1,"position":[600,1120]},{"parameters":{"operation":"editMessageText","chatId":"={{ $('Execute Workflow Trigger').item.json.message.chat.id }}","messageId":"={{ $('Execute Workflow Trigger').item.json.message.message_id -1 }}","text":"=Вы выбрали получателя <b>{{ $('Execute Workflow Trigger').item.json.logist_recipient_name }}</b>. Введите текст сообщения для водителей:","additionalFields":{"parse_mode":"HTML"}},"id":"d2787e07-3eba-4229-8c95-676748e9341b","name":"убираем кнопку назад1","type":"n8n-nodes-base.telegram","typeVersion":1.1,"position":[3460,1440],"credentials":{"telegramApi":{"id":"rJQteGH5Ng1RKmF4","name":"tg dev aleksey"}},"onError":"continueRegularOutput"},{"parameters":{"chatId":"={{ $('Execute Workflow Trigger').item.json.message.chat.id }}","text":"=<b>Действительно хотите оповестить всех водителей?</b>\n\nВаше сообщение:\n<i>{{ $('Execute Workflow Trigger').item.json.message.text }}</i>","replyMarkup":"inlineKeyboard","inlineKeyboard":{"rows":[{"row":{"buttons":[{"text":"Оповестить","additionalFields":{"callback_data":"alert_all"}}]}},{"row":{"buttons":[{"text":"Вернуться к выбору","additionalFields":{"callback_data":"back_to_alert_menu"}}]}}]},"additionalFields":{"appendAttribution":false,"parse_mode":"HTML"}},"id":"b1693fb2-c774-48a9-850f-ca7412b9afa3","name":"действительно оповестить всех?","type":"n8n-nodes-base.telegram","typeVersion":1.1,"position":[3240,1240],"credentials":{"telegramApi":{"id":"rJQteGH5Ng1RKmF4","name":"tg dev aleksey"}}},{"parameters":{"operation":"editMessageText","chatId":"={{ $('Execute Workflow Trigger').item.json.callback_query.message.chat.id }}","messageId":"={{ $('Execute Workflow Trigger').item.json.callback_query.message.message_id }}","text":"Сообщение будет доставлено всем водителям на смене","additionalFields":{}},"id":"c488fd56-a014-440c-9f9a-919cd5e4c410","name":"изменяем сообщение","type":"n8n-nodes-base.telegram","typeVersion":1.1,"position":[2500,2040],"credentials":{"telegramApi":{"id":"rJQteGH5Ng1RKmF4","name":"tg dev aleksey"}}},{"parameters":{"chatId":"={{ $('Execute Workflow Trigger').item.json.message.chat.id }}","text":"=<b>Действительно хотите оповестить водителя?</b>\n\nВаше сообщение:\n<i>{{ $('Execute Workflow Trigger').item.json.message.text }}</i>","replyMarkup":"inlineKeyboard","inlineKeyboard":{"rows":[{"row":{"buttons":[{"text":"Оповестить","additionalFields":{"callback_data":"alert_auto"}}]}},{"row":{"buttons":[{"text":"Вернуться к выбору","additionalFields":{"callback_data":"back_to_alert_menu"}}]}}]},"additionalFields":{"appendAttribution":false,"parse_mode":"HTML"}},"id":"0a47c6ee-0ec7-4ddd-89bd-a9a8d15b4501","name":"оповестить по водителю?","type":"n8n-nodes-base.telegram","typeVersion":1.1,"position":[3240,1660],"credentials":{"telegramApi":{"id":"rJQteGH5Ng1RKmF4","name":"tg dev aleksey"}}},{"parameters":{"content":"## Данные водителя","height":291.3280243517646,"width":859.843468703775,"color":6},"id":"449138e6-a61c-45e3-809c-bec5ed5ab292","name":"Sticky Note5","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1600,3820]},{"parameters":{"operation":"update","schema":{"__rl":true,"mode":"list","value":"public"},"table":{"__rl":true,"value":"tg_users","mode":"list","cachedResultName":"tg_users"},"columns":{"mappingMode":"defineBelow","value":{"tg_id":"={{ $('Execute Workflow Trigger').all()[0].json.callback_query.message.chat.id }}","logist_recipient_name":"={{ $('Execute Workflow Trigger').all()[0].json.callback_query.data }}"},"matchingColumns":["tg_id"],"schema":[{"id":"tg_id","displayName":"tg_id","required":true,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":false},{"id":"odoo_id","displayName":"odoo_id","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"status","displayName":"status","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"only_mech","displayName":"only_mech","required":false,"defaultMatch":false,"display":true,"type":"boolean","canBeUsedToMatch":true,"removed":true},{"id":"mech_photo","displayName":"mech_photo","required":false,"defaultMatch":false,"display":true,"type":"boolean","canBeUsedToMatch":true,"removed":true},{"id":"end_request_id","displayName":"end_request_id","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"materials_photo","displayName":"materials_photo","required":false,"defaultMatch":false,"display":true,"type":"boolean","canBeUsedToMatch":true,"removed":true},{"id":"end_request_hours","displayName":"end_request_hours","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"car_id_while_inputing","displayName":"car_id_while_inputing","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"fuel_liters","displayName":"fuel_liters","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"weight_measure","displayName":"weight_measure","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"logist_alert_text","displayName":"logist_alert_text","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"logist_recipient_name","displayName":"logist_recipient_name","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"transportation_for_certificate","displayName":"transportation_for_certificate","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"count_weight_photo","displayName":"count_weight_photo","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"count_weight_photo_sent","displayName":"count_weight_photo_sent","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true}]},"options":{}},"id":"9d2a5d83-3edc-4451-b14a-1600ce2aa8b1","name":"сохраним получателя","type":"n8n-nodes-base.postgres","typeVersion":2.3,"position":[2780,3580],"credentials":{"postgres":{"id":"xrihBpyZE5y4OBiy","name":"pg dev"}}},{"parameters":{"operation":"editMessageText","chatId":"={{ $('Execute Workflow Trigger').item.json.callback_query.message.chat.id }}","messageId":"={{ $('Execute Workflow Trigger').item.json.callback_query.message.message_id }}","replyMarkup":"inlineKeyboard","text":"=Текущий водитель {{ $('данные авто').item.json.number_car }}:\n{{ $('данные авто').item.json.driver_id[1] }} <a href=\"tel:{{ $json.mobile_phone }}\">{{ $json.mobile_phone }}</a>\n\nВведите текст сообщения:","inlineKeyboard":{"rows":[{"row":{"buttons":[{"text":"Назад","additionalFields":{"callback_data":"={{ $('Execute Workflow Trigger').item.json.logist_recipient_name }}"}}]}}]},"additionalFields":{"parse_mode":"HTML"}},"id":"e319f8cc-ca96-4d7e-9659-a382c2231bd1","name":"Введите текст","type":"n8n-nodes-base.telegram","typeVersion":1.1,"position":[2060,3880],"credentials":{"telegramApi":{"id":"rJQteGH5Ng1RKmF4","name":"tg dev aleksey"}}},{"parameters":{"operation":"deleteMessage","chatId":"={{ $('Execute Workflow Trigger').item.json.message.chat.id }}","messageId":"={{ $('Execute Workflow Trigger').item.json.message.message_id -1 }}"},"id":"2544b232-2b62-4693-a8a5-3b8e35940403","name":"убираем кнопку назад2","type":"n8n-nodes-base.telegram","typeVersion":1.1,"position":[3460,1660],"credentials":{"telegramApi":{"id":"rJQteGH5Ng1RKmF4","name":"tg dev aleksey"}},"onError":"continueRegularOutput"},{"parameters":{"operation":"update","schema":{"__rl":true,"mode":"list","value":"public"},"table":{"__rl":true,"value":"tg_users","mode":"list","cachedResultName":"tg_users"},"columns":{"mappingMode":"defineBelow","value":{"tg_id":"={{ $('Execute Workflow Trigger').item.json.callback_query.message.chat.id }}","status":"inputing_alert_for_auto","logist_recipient_name":"={{ $('данные авто').item.json.driver_id[0] }}"},"matchingColumns":["tg_id"],"schema":[{"id":"tg_id","displayName":"tg_id","required":true,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":false},{"id":"odoo_id","displayName":"odoo_id","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"status","displayName":"status","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"only_mech","displayName":"only_mech","required":false,"defaultMatch":false,"display":true,"type":"boolean","canBeUsedToMatch":true,"removed":true},{"id":"mech_photo","displayName":"mech_photo","required":false,"defaultMatch":false,"display":true,"type":"boolean","canBeUsedToMatch":true,"removed":true},{"id":"end_request_id","displayName":"end_request_id","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"materials_photo","displayName":"materials_photo","required":false,"defaultMatch":false,"display":true,"type":"boolean","canBeUsedToMatch":true,"removed":true},{"id":"end_request_hours","displayName":"end_request_hours","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"car_id_while_inputing","displayName":"car_id_while_inputing","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"fuel_liters","displayName":"fuel_liters","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"weight_measure","displayName":"weight_measure","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"logist_alert_text","displayName":"logist_alert_text","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"logist_recipient_name","displayName":"logist_recipient_name","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"transportation_for_certificate","displayName":"transportation_for_certificate","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"count_weight_photo","displayName":"count_weight_photo","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"count_weight_photo_sent","displayName":"count_weight_photo_sent","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true}]},"options":{}},"id":"c330c99f-51bf-45c1-ba03-a0d6104f6b98","name":"обновим статус","type":"n8n-nodes-base.postgres","typeVersion":2.3,"position":[2280,3880],"credentials":{"postgres":{"id":"xrihBpyZE5y4OBiy","name":"pg dev"}}},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict"},"conditions":[{"leftValue":"={{ $json.callback_query.data }}","rightValue":"={{ \"AT_\" }}","operator":{"type":"string","operation":"startsWith"}}],"combinator":"and"}},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict"},"conditions":[{"id":"954e80e5-89fc-4093-b0dc-fa39a23981d8","leftValue":"={{ $json.callback_query.data }}","rightValue":"alert_transportation","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"}},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict"},"conditions":[{"id":"a0342fdb-9d78-4568-a12f-78a834e4beb3","leftValue":"={{ $json.callback_query.data }}","rightValue":"={{ \"CT_\" }}","operator":{"type":"string","operation":"startsWith"}}],"combinator":"and"}},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict"},"conditions":[{"id":"46c02646-5c28-434d-9b36-e7122502fcd6","leftValue":"={{ $json.callback_query.data }}","rightValue":"={{ \"AA_\" }}","operator":{"type":"string","operation":"startsWith"}}],"combinator":"and"}},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict"},"conditions":[{"id":"4b24e9f4-fcd8-46b6-a853-71cb4b316917","leftValue":"={{ $json.callback_query.data }}","rightValue":"alert_auto","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"}}]},"options":{}},"id":"0bf7b822-5894-4580-ba25-33800300ae8b","name":"выбор получателя","type":"n8n-nodes-base.switch","typeVersion":3,"position":[1360,3260]},{"parameters":{"operation":"select","schema":{"__rl":true,"mode":"list","value":"public"},"table":{"__rl":true,"value":"tg_users","mode":"list","cachedResultName":"tg_users"},"returnAll":true,"where":{"values":[{"column":"odoo_id","value":"={{ $json.logist_recipient_name }}"}]},"options":{}},"id":"306b1eb7-0d1f-4692-839c-7c4f8ce62044","name":"айди водителей2","type":"n8n-nodes-base.postgres","typeVersion":2.3,"position":[1620,4240],"credentials":{"postgres":{"id":"xrihBpyZE5y4OBiy","name":"pg dev"}}},{"parameters":{"chatId":"={{ $('айди водителей2').item.json.tg_id }}","text":"=Оповещение от логиста {{ $json.display_name }}:\n<i>{{ $('Execute Workflow Trigger').all()[0].json.logist_alert_text }}</i>","additionalFields":{"appendAttribution":false,"parse_mode":"HTML"}},"id":"0d2fb246-6e61-4684-9701-fa1ef554c14d","name":"рассылка2","type":"n8n-nodes-base.telegram","typeVersion":1.1,"position":[2060,4240],"credentials":{"telegramApi":{"id":"rJQteGH5Ng1RKmF4","name":"tg dev aleksey"}}},{"parameters":{"aggregate":"aggregateAllItemData","options":{}},"id":"be8e0e3f-b8ff-4f53-8394-ed16cdf70b42","name":"преобразуем в 1 переменную2","type":"n8n-nodes-base.aggregate","typeVersion":1,"position":[2300,4240]},{"parameters":{"operation":"editMessageText","chatId":"={{ $('Execute Workflow Trigger').all()[0].json.callback_query.message.chat.id }}","messageId":"={{ $('Execute Workflow Trigger').all()[0].json.callback_query.message.message_id }}","text":"Сообщение будет доставлено водителю","additionalFields":{}},"id":"a64673ea-3f3e-41fd-afe1-c5bf43f960f3","name":"изменяем сообщение2","type":"n8n-nodes-base.telegram","typeVersion":1.1,"position":[2520,4240],"credentials":{"telegramApi":{"id":"rJQteGH5Ng1RKmF4","name":"tg dev aleksey"}}},{"parameters":{"operation":"update","schema":{"__rl":true,"mode":"list","value":"public"},"table":{"__rl":true,"value":"tg_users","mode":"list","cachedResultName":"tg_users"},"columns":{"mappingMode":"defineBelow","value":{"tg_id":"={{ $('Execute Workflow Trigger').item.json.callback_query.message.chat.id }}","status":"authorized","logist_alert_text":"={{ null }}","logist_recipient_name":"={{null}}"},"matchingColumns":["tg_id"],"schema":[{"id":"tg_id","displayName":"tg_id","required":true,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":false},{"id":"odoo_id","displayName":"odoo_id","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"status","displayName":"status","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"only_mech","displayName":"only_mech","required":false,"defaultMatch":false,"display":true,"type":"boolean","canBeUsedToMatch":true,"removed":true},{"id":"mech_photo","displayName":"mech_photo","required":false,"defaultMatch":false,"display":true,"type":"boolean","canBeUsedToMatch":true,"removed":true},{"id":"end_request_id","displayName":"end_request_id","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"materials_photo","displayName":"materials_photo","required":false,"defaultMatch":false,"display":true,"type":"boolean","canBeUsedToMatch":true,"removed":true},{"id":"end_request_hours","displayName":"end_request_hours","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"car_id_while_inputing","displayName":"car_id_while_inputing","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"fuel_liters","displayName":"fuel_liters","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"weight_measure","displayName":"weight_measure","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"logist_alert_text","displayName":"logist_alert_text","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"logist_recipient_name","displayName":"logist_recipient_name","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"transportation_for_certificate","displayName":"transportation_for_certificate","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"count_weight_photo","displayName":"count_weight_photo","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"count_weight_photo_sent","displayName":"count_weight_photo_sent","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true}]},"options":{}},"id":"d50c9ecf-c958-44ac-a2ae-0fa088efd478","name":"очищаем лишнее","type":"n8n-nodes-base.postgres","typeVersion":2.3,"position":[2720,4240],"credentials":{"postgres":{"id":"xrihBpyZE5y4OBiy","name":"pg dev"}}},{"parameters":{"content":"## Рассылка конкретному водителю","height":291.3280243517646,"width":1062.8959494683481,"color":6},"id":"679b8432-ce5b-449e-9efb-0e746c18bc31","name":"Sticky Note6","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1600,4160]},{"parameters":{"resource":"custom","customResource":"hr.employee","operation":"get","customResourceId":"={{ $('Execute Workflow Trigger').item.json.odoo_id }}","options":{}},"id":"bfb38c44-b67d-44c2-9717-bfc85a987611","name":"данные логиста","type":"n8n-nodes-base.odoo","typeVersion":1,"position":[1840,4240],"credentials":{"odooApi":{"id":"ITgOrhO4Hf2QcDtf","name":"odoo dev"}}}],"connections":{"Проверка свободных машин":{"main":[[{"node":"Поиск машин со статусом Нет груза","type":"main","index":0}]]},"Поиск машин со статусом Нет груза":{"main":[[{"node":"Вывод свободных машин","type":"main","index":0}]]},"проверка типа сообщения":{"main":[[{"node":"Проверка старта1","type":"main","index":0}],[{"node":"инлайн кнопки для логиста","type":"main","index":0}]]},"введите текст для всех":{"main":[[{"node":"статус=ввод оповещения для всех","type":"main","index":0}]]},"айди водителей":{"main":[[{"node":"рассылка","type":"main","index":0}]]},"рассылка":{"main":[[{"node":"преобразуем в 1 переменную","type":"main","index":0}]]},"преобразуем в 1 переменную":{"main":[[{"node":"изменяем сообщение","type":"main","index":0}]]},"все сегодняшние перевозки":{"main":[[{"node":"проверка наличия перевозок","type":"main","index":0}]]},"получим получателей без дубликатов":{"main":[[{"node":"создаём динамически инлайн кнопки","type":"main","index":0}]]},"проверка наличия перевозок":{"main":[[{"node":"получим получателей без дубликатов","type":"main","index":0}],[{"node":"заявки не найдены","type":"main","index":0}]]},"создаём динамически инлайн кнопки":{"main":[[{"node":"отправляем сообщение","type":"main","index":0}]]},"отправляем сообщение":{"main":[[{"node":"удаляем прошлое сообщение с заявками","type":"main","index":0}]]},"введите текст для получателя":{"main":[[{"node":"статус=ввод сообщения для получателя","type":"main","index":0}]]},"название получателя":{"main":[[{"node":"введите текст для получателя","type":"main","index":0}]]},"кнопка оповещения1":{"main":[[{"node":"дефолтный статус","type":"main","index":0}]]},"оповестить по перевозке?":{"main":[[{"node":"убираем кнопку назад1","type":"main","index":0}]]},"перевозки по получателю":{"main":[[{"node":"все рейсы","type":"main","index":0}]]},"все рейсы":{"main":[[{"node":"автомобили по рейсу на смене","type":"main","index":0}]]},"поиск машин на смене":{"main":[[{"node":"айди водителей","type":"main","index":0}]]},"автомобили по рейсу на смене":{"main":[[{"node":"айди водителей1","type":"main","index":0}]]},"айди водителей1":{"main":[[{"node":"рассылка1","type":"main","index":0}]]},"рассылка1":{"main":[[{"node":"преобразуем в 1 переменную1","type":"main","index":0}]]},"преобразуем в 1 переменную1":{"main":[[{"node":"изменяем сообщение1","type":"main","index":0}]]},"Проверка старта1":{"main":[[{"node":"Приветственное сообщений","type":"main","index":0}],[{"node":"Проверка кнопок","type":"main","index":0}]]},"все сегодняшние перевозки1":{"main":[[{"node":"проверка наличия перевозок1","type":"main","index":0}]]},"проверка наличия перевозок1":{"main":[[{"node":"получим получателей без дубликатов1","type":"main","index":0}],[{"node":"заявки не найдены1","type":"main","index":0}]]},"получим получателей без дубликатов1":{"main":[[{"node":"создаём динамически инлайн кнопки1","type":"main","index":0}]]},"создаём динамически инлайн кнопки1":{"main":[[{"node":"отправляем сообщение1","type":"main","index":0}]]},"отправляем сообщение1":{"main":[[{"node":"удаляем прошлое сообщение с заявками1","type":"main","index":0}]]},"перевозки по получателю1":{"main":[[{"node":"все рейсы1","type":"main","index":0}]]},"все рейсы1":{"main":[[{"node":"автомобили по рейсу на смене1","type":"main","index":0}]]},"создаём динамически инлайн кнопки2":{"main":[[{"node":"отправляем сообщение2","type":"main","index":0}]]},"отправляем сообщение2":{"main":[[{"node":"сохраним получателя","type":"main","index":0}]]},"автомобили по рейсу на смене1":{"main":[[{"node":"создаём динамически инлайн кнопки2","type":"main","index":0}]]},"Проверка кнопок":{"main":[[{"node":"Проверка свободных машин","type":"main","index":0}],[{"node":"кнопка оповещения","type":"main","index":0}],[{"node":"проверка статуса","type":"main","index":0}]]},"данные авто":{"main":[[{"node":"номер телефона","type":"main","index":0}]]},"номер телефона":{"main":[[{"node":"Введите текст","type":"main","index":0}]]},"инлайн кнопки для логиста":{"main":[[{"node":"введите текст для всех","type":"main","index":0}],[{"node":"все сегодняшние перевозки","type":"main","index":0}],[{"node":"кнопка оповещения1","type":"main","index":0}],[{"node":"поиск машин на смене","type":"main","index":0}],[{"node":"все сегодняшние перевозки1","type":"main","index":0}],[{"node":"выбор получателя","type":"main","index":0}]]},"проверка статуса":{"main":[[{"node":"действительно оповестить всех?","type":"main","index":0}],[{"node":"оповестить по перевозке?","type":"main","index":0}],[{"node":"оповестить по водителю?","type":"main","index":0}]]},"убираем кнопку назад":{"main":[[{"node":"сохраним текст логиста","type":"main","index":0}]]},"Execute Workflow Trigger":{"main":[[{"node":"проверка типа сообщения","type":"main","index":0},{"node":"Stop and Error","type":"main","index":0}]]},"убираем кнопку назад1":{"main":[[{"node":"сохраним текст логиста","type":"main","index":0}]]},"действительно оповестить всех?":{"main":[[{"node":"убираем кнопку назад","type":"main","index":0}]]},"оповестить по водителю?":{"main":[[{"node":"убираем кнопку назад2","type":"main","index":0}]]},"сохраним получателя":{"main":[[{"node":"удаляем прошлое сообщение с заявками2","type":"main","index":0}]]},"Введите текст":{"main":[[{"node":"обновим статус","type":"main","index":0}]]},"убираем кнопку назад2":{"main":[[{"node":"сохраним текст логиста","type":"main","index":0}]]},"выбор получателя":{"main":[[{"node":"название получателя","type":"main","index":0}],[{"node":"перевозки по получателю","type":"main","index":0}],[{"node":"перевозки по получателю1","type":"main","index":0}],[{"node":"данные авто","type":"main","index":0}],[{"node":"айди водителей2","type":"main","index":0}]]},"айди водителей2":{"main":[[{"node":"данные логиста","type":"main","index":0}]]},"рассылка2":{"main":[[{"node":"преобразуем в 1 переменную2","type":"main","index":0}]]},"преобразуем в 1 переменную2":{"main":[[{"node":"изменяем сообщение2","type":"main","index":0}]]},"изменяем сообщение2":{"main":[[{"node":"очищаем лишнее","type":"main","index":0}]]},"данные логиста":{"main":[[{"node":"рассылка2","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{"Execute Workflow Trigger":[{"json":{"update_id":100621927,"message":{"message_id":13177,"from":{"id":7090302459,"is_bot":false,"first_name":"Al","last_name":"Go","language_code":"ru"},"chat":{"id":7090302459,"first_name":"Al","last_name":"Go","type":"private"},"date":1721979002,"text":"/start","entities":[{"offset":0,"length":6,"type":"bot_command"}]},"tg_id":"7090302459","odoo_id":19,"status":"authorized","only_mech":false,"mech_photo":false,"end_request_id":null,"materials_photo":false,"end_request_hours":null,"car_id_while_inputing":null,"fuel_liters":null,"weight_measure":null,"logist_alert_text":null,"logist_recipient_name":null,"transportation_for_certificate":null,"count_weight_photo":null,"count_weight_photo_sent":null,"cookie":"session_id=78f5f11dbc005ee8a33b2b4961110602a991f6b3; Expires=Sat, 26 Jul 2025 07:30:14 GMT; Max-Age=604800; HttpOnly; Path=/"}}]},"versionId":"8f633f13-79e6-4ff5-831a-91c9870e106d","triggerCount":0,"tags":[{"createdAt":"2024-08-26T14:03:49.624Z","updatedAt":"2024-08-26T14:03:49.624Z","id":"sYBV4z8jwrWgz2Cc","name":"aleksey"}]}